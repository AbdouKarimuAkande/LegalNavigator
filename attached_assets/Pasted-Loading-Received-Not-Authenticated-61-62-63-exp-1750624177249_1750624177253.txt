Loading
    Received:
      Not Authenticated

      61 |     );
      62 |
    > 63 |     expect(screen.getByTestId('auth-status')).toHaveTextContent('Loading');
         |                                               ^
      64 |   });
      65 |
      66 |   it('should handle successful login', async () => {

      at Object.<anonymous> (client/src/__tests__/auth.test.tsx:63:47)


 RUNS  client/src/__tests__/auth.test.tsx
 RUNS  server/__tests__/integration/routes.integration.test.ts
 RUNS  tests/unit/storage.test.ts
 RUNS  server/__tests__/storage.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts
 RUNS  tests/unit/storage.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts
 RUNS  tests/unit/storage.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts
 RUNS  tests/unit/storage.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts
 RUNS  tests/unit/storage.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts
 RUNS  tests/unit/storage.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts
 FAIL  server/__tests__/integration/routes.integration.test.ts

 RUNS  server/__tests__/integration/routes.integration.test.ts
  ● Test suite failed to run

    server/__tests__/integration/routes.integration.test.ts:7:1 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or 
`npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.    

    7 describe('Routes Integration Tests', () => {
      ~~~~~~~~
    server/__tests__/integration/routes.integration.test.ts:11:3 - error TS2304: Cannot find name 'beforeAll'.

    11   beforeAll(async () => {
         ~~~~~~~~~
    server/__tests__/integration/routes.integration.test.ts:17:3 - error TS2304: Cannot find name 'afterAll'.

    17   afterAll(async () => {
         ~~~~~~~~
    server/__tests__/integration/routes.integration.test.ts:23:3 - error TS2304: Cannot find name 'beforeEach'.

    23   beforeEach(async () => {
         ~~~~~~~~~~
    server/__tests__/integration/routes.integration.test.ts:25:5 - error TS2304: Cannot find name 'jest'.

    25     jest.clearAllMocks();
           ~~~~
    server/__tests__/integration/routes.integration.test.ts:28:3 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.   

    28   describe('Authentication Routes', () => {
         ~~~~~~~~
    server/__tests__/integration/routes.integration.test.ts:29:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm 
i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    29     it('should register a new user', async () => {
           ~~
    server/__tests__/integration/routes.integration.test.ts:41:7 - error TS2304: Cannot find name 'expect'.

    41       expect(response.body.user.email).toBe(userData.email);
             ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:42:7 - error TS2304: Cannot find name 'expect'.

    42       expect(response.body.user.name).toBe(userData.name);
             ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:43:7 - error TS2304: Cannot find name 'expect'.

    43       expect(response.body.user.id).toBeDefined();
             ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:44:7 - error TS2304: Cannot find name 'expect'.

    44       expect(response.body.user.password).toBeUndefined();
             ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:47:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm 
i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    47     it('should not register user with existing email', async () => {
           ~~
    server/__tests__/integration/routes.integration.test.ts:57:9 - error TS2353: Object literal may only specify known properties, and 'password' does not exist in type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" 
| "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }'.

    57         password: await bcrypt.hash(userData.password, 10),
               ~~~~~~~~
    server/__tests__/integration/routes.integration.test.ts:69:7 - error TS2304: Cannot find name 'expect'.

    69       expect(response.body.message).toContain('already exists');
             ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:72:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm 
i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    72     it('should login with valid credentials', async () => {
           ~~
    server/__tests__/integration/routes.integration.test.ts:82:9 - error TS2353: Object literal may only specify known properties, and 'password' does not exist in type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" 
| "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }'.

    82         password: await bcrypt.hash(userData.password, 10),
               ~~~~~~~~
    server/__tests__/integration/routes.integration.test.ts:96:7 - error TS2304: Cannot find name 'expect'.

    96       expect(response.body.token).toBeDefined();
             ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:97:7 - error TS2304: Cannot find name 'expect'.

    97       expect(response.body.user.email).toBe(userData.email);
             ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:100:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.        

    100     it('should reject login with invalid credentials', async () => {
            ~~
    server/__tests__/integration/routes.integration.test.ts:109:7 - error TS2304: Cannot find name 'expect'.

    109       expect(response.body.message).toContain('Invalid credentials');
              ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:113:3 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.  

    113   describe('Health Check Routes', () => {
          ~~~~~~~~
    server/__tests__/integration/routes.integration.test.ts:114:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.        

    114     it('should return health status', async () => {
            ~~
    server/__tests__/integration/routes.integration.test.ts:119:7 - error TS2304: Cannot find name 'expect'.

    119       expect(response.body.status).toBe('healthy');
              ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:120:7 - error TS2304: Cannot find name 'expect'.

    120       expect(response.body.timestamp).toBeDefined();
              ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:123:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.        

    123     it('should return metrics', async () => {
            ~~
    server/__tests__/integration/routes.integration.test.ts:128:7 - error TS2304: Cannot find name 'expect'.

    128       expect(response.text).toContain('# HELP');
              ~~~~~~
    server/__tests__/integration/routes.integration.test.ts:129:7 - error TS2304: Cannot find name 'expect'.

    129       expect(response.text).toContain('# TYPE');
              ~~~~~~


 RUNS  server/__tests__/integration/routes.integration.test.ts


 FAIL  server/__tests__/storage.test.ts      

  ● Test suite failed to run

    server/__tests__/storage.test.ts:4:1 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    4 describe('Storage Layer Tests', () => {
      ~~~~~~~~
    server/__tests__/storage.test.ts:5:3 - error TS2304: Cannot find name 'beforeEach'.

    5   beforeEach(() => {
        ~~~~~~~~~~
    server/__tests__/storage.test.ts:14:3 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    14   describe('User Operations', () => {
         ~~~~~~~~
    server/__tests__/storage.test.ts:15:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    15     it('should create a new user', async () => {
           ~~
    server/__tests__/storage.test.ts:25:45 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is 
not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | 
undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

    25       const user = await storage.createUser(userData);
                                                   ~~~~~~~~
    server/__tests__/storage.test.ts:27:7 - error TS2304: Cannot find name 'expect'.

    27       expect(user.id).toBeDefined();
             ~~~~~~
    server/__tests__/storage.test.ts:28:7 - error TS2304: Cannot find name 'expect'.

    28       expect(user.email).toBe(userData.email);
             ~~~~~~
    server/__tests__/storage.test.ts:29:7 - error TS2304: Cannot find name 'expect'.

    29       expect(user.name).toBe(userData.name);
             ~~~~~~
    server/__tests__/storage.test.ts:30:7 - error TS2304: Cannot find name 'expect'.

    30       expect(user.createdAt).toBeInstanceOf(Date);
             ~~~~~~
    server/__tests__/storage.test.ts:31:7 - error TS2304: Cannot find name 'expect'.

    31       expect(user.updatedAt).toBeInstanceOf(Date);
             ~~~~~~
    server/__tests__/storage.test.ts:34:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    34     it('should retrieve user by email', async () => {
           ~~
    server/__tests__/storage.test.ts:44:52 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is 
not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | 
undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

    44       const createdUser = await storage.createUser(userData);
                                                          ~~~~~~~~
    server/__tests__/storage.test.ts:47:7 - error TS2304: Cannot find name 'expect'.

    47       expect(foundUser).toBeDefined();
             ~~~~~~
    server/__tests__/storage.test.ts:48:7 - error TS2304: Cannot find name 'expect'.

    48       expect(foundUser?.id).toBe(createdUser.id);
             ~~~~~~
    server/__tests__/storage.test.ts:51:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    51     it('should update user information', async () => {
           ~~
    server/__tests__/storage.test.ts:61:45 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is 
not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | 
undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

    61       const user = await storage.createUser(userData);
                                                   ~~~~~~~~
    server/__tests__/storage.test.ts:67:7 - error TS2304: Cannot find name 'expect'.

    67       expect(updatedUser.name).toBe('Updated Name');
             ~~~~~~
    server/__tests__/storage.test.ts:68:7 - error TS2304: Cannot find name 'expect'.

    68       expect(updatedUser.emailVerified).toBe(true);
             ~~~~~~
    server/__tests__/storage.test.ts:69:7 - error TS2304: Cannot find name 'expect'.

    69       expect(updatedUser.updatedAt.getTime()).toBeGreaterThan(user.updatedAt.getTime());        
             ~~~~~~
    server/__tests__/storage.test.ts:69:14 - error TS18047: 'updatedUser.updatedAt' is possibly 'null'.
    69       expect(updatedUser.updatedAt.getTime()).toBeGreaterThan(user.updatedAt.getTime());        
                    ~~~~~~~~~~~~~~~~~~~~~
    server/__tests__/storage.test.ts:69:63 - error TS18047: 'user.updatedAt' is possibly 'null'.       

    69       expect(updatedUser.updatedAt.getTime()).toBeGreaterThan(user.updatedAt.getTime());        
                                                                     ~~~~~~~~~~~~~~
    server/__tests__/storage.test.ts:73:3 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    73   describe('Chat Operations', () => {
         ~~~~~~~~
    server/__tests__/storage.test.ts:74:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    74     it('should create chat session', async () => {
           ~~
    server/__tests__/storage.test.ts:84:45 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is 
not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | 
undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

    84       const user = await storage.createUser(userData);
                                                   ~~~~~~~~
    server/__tests__/storage.test.ts:91:55 - error TS2345: Argument of type '{ userId: string; title: string; status: string; }' is not assignable to parameter of type '{ userId: string; title: string; status?: "active" | "completed" | "archived" | null | undefined; language?: "en" | "fr" | null | undefined; }'.
      Types of property 'status' are incompatible.
        Type 'string' is not assignable to type '"active" | "completed" | "archived" | null | undefined'.

    91       const session = await storage.createChatSession(sessionData);
                                                             ~~~~~~~~~~~
    server/__tests__/storage.test.ts:93:7 - error TS2304: Cannot find name 'expect'.

    93       expect(session.id).toBeDefined();
             ~~~~~~
    server/__tests__/storage.test.ts:94:7 - error TS2304: Cannot find name 'expect'.

    94       expect(session.userId).toBe(user.id);
             ~~~~~~
    server/__tests__/storage.test.ts:95:7 - error TS2304: Cannot find name 'expect'.

    95       expect(session.title).toBe('Legal Consultation');
             ~~~~~~
    server/__tests__/storage.test.ts:96:7 - error TS2304: Cannot find name 'expect'.

    96       expect(session.status).toBe('active');
             ~~~~~~
    server/__tests__/storage.test.ts:99:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    99     it('should create and retrieve chat messages', async () => {
           ~~
    server/__tests__/storage.test.ts:109:45 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 
more ... | undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

    109       const user = await storage.createUser(userData);
                                                    ~~~~~~~~
    server/__tests__/storage.test.ts:123:55 - error TS2345: Argument of type '{ sessionId: string; userId: string; content: string; sender: "user"; }' is not assignable to parameter of type '{ role: "user" 
| "assistant"; sessionId: string; content: string; category?: string | null | undefined; confidence?: string | null | undefined; referencesData?: Json | undefined; }'.
      Property 'role' is missing in type '{ sessionId: string; userId: string; content: string; sender: "user"; }' but required in type '{ role: "user" | "assistant"; sessionId: string; content: string; category?: string | null | undefined; confidence?: string | null | undefined; referencesData?: Json | undefined; }'.

    123       const message = await storage.createChatMessage(messageData);
                                                              ~~~~~~~~~~~

      shared/schema.ts:44:3
        44   role: mysqlEnum("role", ["user", "assistant"]).notNull(),
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        'role' is declared here.
    server/__tests__/storage.test.ts:126:7 - error TS2304: Cannot find name 'expect'.

    126       expect(message.id).toBeDefined();
              ~~~~~~
    server/__tests__/storage.test.ts:127:7 - error TS2304: Cannot find name 'expect'.

    127       expect(message.content).toBe('What are my rights?');
              ~~~~~~
    server/__tests__/storage.test.ts:128:7 - error TS2304: Cannot find name 'expect'.

    128       expect(messages).toHaveLength(1);
              ~~~~~~
    server/__tests__/storage.test.ts:129:7 - error TS2304: Cannot find name 'expect'.

    129       expect(messages[0].id).toBe(message.id);
              ~~~~~~
    server/__tests__/storage.test.ts:133:3 - error TS2593: Cannot find name 'describe'. Do you need to 
install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    133   describe('Verification Code Operations', () => {
          ~~~~~~~~
    server/__tests__/storage.test.ts:134:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    134     it('should create and retrieve verification codes', async () => {
            ~~
    server/__tests__/storage.test.ts:144:45 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 
more ... | undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

    144       const user = await storage.createUser(userData);
                                                    ~~~~~~~~
    server/__tests__/storage.test.ts:153:69 - error TS2345: Argument of type '{ userId: string; code: string; type: string; used: boolean; expiresAt: Date; }' is not assignable to parameter of type '{ code: string; type: "email_verification" | "password_reset" | "two_factor"; userId: string; expiresAt: Date; used?: boolean | null | undefined; }'.
      Types of property 'type' are incompatible.
        Type 'string' is not assignable to type '"email_verification" | "password_reset" | "two_factor"'.

    153       const verificationCode = await storage.createVerificationCode(codeData);
                                                                            ~~~~~~~~
    server/__tests__/storage.test.ts:160:7 - error TS2304: Cannot find name 'expect'.

    160       expect(verificationCode.id).toBeDefined();
              ~~~~~~
    server/__tests__/storage.test.ts:161:7 - error TS2304: Cannot find name 'expect'.

    161       expect(retrievedCode).toBeDefined();
              ~~~~~~
    server/__tests__/storage.test.ts:162:7 - error TS2304: Cannot find name 'expect'.

    162       expect(retrievedCode?.code).toBe('123456');
              ~~~~~~
    server/__tests__/storage.test.ts:163:7 - error TS2304: Cannot find name 'expect'.

    163       expect(retrievedCode?.used).toBe(false);
              ~~~~~~
    server/__tests__/storage.test.ts:166:5 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    166     it('should mark verification code as used', async () => {
            ~~
    server/__tests__/storage.test.ts:176:45 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 
more ... | undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: boolean; twoFactorEnabled: boolean; emailVerified: boolean; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

    176       const user = await storage.createUser(userData);
                                                    ~~~~~~~~
    server/__tests__/storage.test.ts:185:69 - error TS2345: Argument of type '{ userId: string; code: string; type: string; used: boolean; expiresAt: Date; }' is not assignable to parameter of type '{ code: string; type: "email_verification" | "password_reset" | "two_factor"; userId: string; expiresAt: Date; used?: boolean | null | undefined; }'.
      Types of property 'type' are incompatible.
        Type 'string' is not assignable to type '"email_verification" | "password_reset" | "two_factor"'.

    185       const verificationCode = await storage.createVerificationCode(codeData);
                                                                            ~~~~~~~~
    server/__tests__/storage.test.ts:194:7 - error TS2304: Cannot find name 'expect'.

    194       expect(retrievedCode).toBeUndefined(); // Should not find used codes
              ~~~~~~


 FAIL  server/__tests__/routes.test.ts       
  ● Test suite failed to run

    server/__tests__/routes.test.ts:7:1 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    7 describe('API Routes Integration Tests', () => {
      ~~~~~~~~
    server/__tests__/routes.test.ts:11:3 - error TS2304: Cannot find name 'beforeAll'.

    11   beforeAll(async () => {
         ~~~~~~~~~
    server/__tests__/routes.test.ts:14:35 - error TS2345: Argument of type 'Application' is not assignable to parameter of type 'Express'.
      Type 'Application<Record<string, any>>' is missing the following properties from type 'Express': 
request, response

    14     server = await registerRoutes(app);
                                         ~~~
    server/__tests__/routes.test.ts:17:3 - error TS2304: Cannot find name 'beforeEach'.

    17   beforeEach(() => {
         ~~~~~~~~~~
    server/__tests__/routes.test.ts:25:3 - error TS2304: Cannot find name 'afterAll'.

    25   afterAll(() => {
         ~~~~~~~~
    server/__tests__/routes.test.ts:29:3 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    29   describe('Authentication Routes', () => {
         ~~~~~~~~
    server/__tests__/routes.test.ts:30:5 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    30     describe('POST /api/auth/register', () => {
           ~~~~~~~~
    server/__tests__/routes.test.ts:31:7 - error TS2593: Cannot find name 'it'. Do you need to install 
type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    31       it('should register a new user successfully', async () => {
             ~~
    server/__tests__/routes.test.ts:43:9 - error TS2304: Cannot find name 'expect'.

    43         expect(response.body.message).toContain('registered successfully');
               ~~~~~~
    server/__tests__/routes.test.ts:44:9 - error TS2304: Cannot find name 'expect'.

    44         expect(response.body.userId).toBeDefined();
               ~~~~~~
    server/__tests__/routes.test.ts:47:7 - error TS2593: Cannot find name 'it'. Do you need to install 
type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    47       it('should reject duplicate email registration', async () => {
             ~~
    server/__tests__/routes.test.ts:67:7 - error TS2593: Cannot find name 'it'. Do you need to install 
type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    67       it('should validate required fields', async () => {
             ~~
    server/__tests__/routes.test.ts:80:5 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    80     describe('POST /api/auth/login', () => {
           ~~~~~~~~
    server/__tests__/routes.test.ts:81:7 - error TS2304: Cannot find name 'beforeEach'.

    81       beforeEach(async () => {
             ~~~~~~~~~~
    server/__tests__/routes.test.ts:84:34 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: false; twoFactorEnabled: false; emailVerified: true; }' is not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... 
| undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: false; twoFactorEnabled: false; emailVerified: true; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

     84         await storage.createUser({
                                         ~
     85           email: 'test@example.com',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ...
     90           emailVerified: true
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     91         });
        ~~~~~~~~~
    server/__tests__/routes.test.ts:94:7 - error TS2593: Cannot find name 'it'. Do you need to install 
type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    94       it('should login with valid credentials', async () => {
             ~~
    server/__tests__/routes.test.ts:103:9 - error TS2304: Cannot find name 'expect'.

    103         expect(response.body.token).toBeDefined();
                ~~~~~~
    server/__tests__/routes.test.ts:104:9 - error TS2304: Cannot find name 'expect'.

    104         expect(response.body.user).toBeDefined();
                ~~~~~~
    server/__tests__/routes.test.ts:105:9 - error TS2304: Cannot find name 'expect'.

    105         expect(response.body.user.email).toBe('test@example.com');
                ~~~~~~
    server/__tests__/routes.test.ts:108:7 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    108       it('should reject invalid credentials', async () => {
              ~~
    server/__tests__/routes.test.ts:118:7 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    118       it('should reject non-existent user', async () => {
              ~~
    server/__tests__/routes.test.ts:130:3 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    130   describe('Chat Routes', () => {
          ~~~~~~~~
    server/__tests__/routes.test.ts:134:5 - error TS2304: Cannot find name 'beforeEach'.

    134     beforeEach(async () => {
            ~~~~~~~~~~
    server/__tests__/routes.test.ts:137:45 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: false; twoFactorEnabled: false; emailVerified: true; }' is not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: false; twoFactorEnabled: false; emailVerified: true; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

    137       const user = await storage.createUser({
                                                    ~
    138         email: 'test@example.com',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ...
    143         emailVerified: true
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    144       });
        ~~~~~~~
    server/__tests__/routes.test.ts:157:5 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    157     describe('POST /api/chat/sessions', () => {
            ~~~~~~~~
    server/__tests__/routes.test.ts:158:7 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    158       it('should create a new chat session', async () => {
              ~~
    server/__tests__/routes.test.ts:167:9 - error TS2304: Cannot find name 'expect'.

    167         expect(response.body.id).toBeDefined();
                ~~~~~~
    server/__tests__/routes.test.ts:168:9 - error TS2304: Cannot find name 'expect'.

    168         expect(response.body.title).toBe('Legal Consultation');
                ~~~~~~
    server/__tests__/routes.test.ts:169:9 - error TS2304: Cannot find name 'expect'.

    169         expect(response.body.userId).toBe(userId);
                ~~~~~~
    server/__tests__/routes.test.ts:172:7 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    172       it('should require authentication', async () => {
              ~~
    server/__tests__/routes.test.ts:182:5 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    182     describe('GET /api/chat/sessions', () => {
            ~~~~~~~~
    server/__tests__/routes.test.ts:183:7 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    183       it('should retrieve user chat sessions', async () => {
              ~~
    server/__tests__/routes.test.ts:196:9 - error TS2304: Cannot find name 'expect'.

    196         expect(Array.isArray(response.body)).toBe(true);
                ~~~~~~
    server/__tests__/routes.test.ts:197:9 - error TS2304: Cannot find name 'expect'.

    197         expect(response.body).toHaveLength(1);
                ~~~~~~
    server/__tests__/routes.test.ts:198:9 - error TS2304: Cannot find name 'expect'.

    198         expect(response.body[0].title).toBe('Test Session');
                ~~~~~~
    server/__tests__/routes.test.ts:203:3 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    203   describe('AI Legal Query Route', () => {
          ~~~~~~~~
    server/__tests__/routes.test.ts:206:5 - error TS2304: Cannot find name 'beforeEach'.

    206     beforeEach(async () => {
            ~~~~~~~~~~
    server/__tests__/routes.test.ts:209:32 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: false; twoFactorEnabled: false; emailVerified: true; }' is not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: false; twoFactorEnabled: false; emailVerified: true; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

    209       await storage.createUser({
                                       ~
    210         email: 'test@example.com',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ...
    215         emailVerified: true
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    216       });
        ~~~~~~~
    server/__tests__/routes.test.ts:228:5 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    228     describe('POST /api/ai/legal-query', () => {
            ~~~~~~~~
    server/__tests__/routes.test.ts:229:7 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    229       it('should process legal query', async () => {
              ~~
    server/__tests__/routes.test.ts:239:9 - error TS2304: Cannot find name 'expect'.

    239         expect(response.body.answer).toBeDefined();
                ~~~~~~
    server/__tests__/routes.test.ts:240:9 - error TS2304: Cannot find name 'expect'.

    240         expect(response.body.category).toBeDefined();
                ~~~~~~
    server/__tests__/routes.test.ts:241:9 - error TS2304: Cannot find name 'expect'.

    241         expect(response.body.confidence).toBeDefined();
                ~~~~~~
    server/__tests__/routes.test.ts:242:9 - error TS2304: Cannot find name 'expect'.

    242         expect(response.body.disclaimer).toBeDefined();
                ~~~~~~
    server/__tests__/routes.test.ts:245:7 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    245       it('should require authentication', async () => {
              ~~
    server/__tests__/routes.test.ts:254:7 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    254       it('should validate query format', async () => {
              ~~
    server/__tests__/routes.test.ts:267:3 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    267   describe('Lawyer Directory Routes', () => {
          ~~~~~~~~
    server/__tests__/routes.test.ts:271:5 - error TS2304: Cannot find name 'beforeEach'.

    271     beforeEach(async () => {
            ~~~~~~~~~~
    server/__tests__/routes.test.ts:274:45 - error TS2345: Argument of type '{ email: string; name: string; passwordHash: string; isLawyer: true; twoFactorEnabled: false; emailVerified: true; }' is not assignable to parameter of type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: "user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 more ...; lastActive?: Date | ... 1 more ... 
| undefined; }'.
      Type '{ email: string; name: string; passwordHash: string; isLawyer: true; twoFactorEnabled: false; emailVerified: true; }' is missing the following properties from type '{ name: string; email: string; passwordHash: string; firstName: string; lastName: string; phone?: string | null | undefined; role?: 
"user" | "lawyer" | "admin" | null | undefined; isLawyer?: boolean | ... 1 more ... | undefined; ... 7 
more ...; lastActive?: Date | ... 1 more ... | undefined; }': firstName, lastName

    274       const user = await storage.createUser({
                                                    ~
    275         email: 'lawyer@example.com',
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    ...
    280         emailVerified: true
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    281       });
        ~~~~~~~
    server/__tests__/routes.test.ts:294:5 - error TS2593: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    294     describe('GET /api/lawyers', () => {
            ~~~~~~~~
    server/__tests__/routes.test.ts:295:7 - error TS2304: Cannot find name 'beforeEach'.

    295       beforeEach(async () => {
              ~~~~~~~~~~
    server/__tests__/routes.test.ts:305:11 - error TS2322: Type 'number' is not assignable to type 'string'.

    305           rating: 450,
                  ~~~~~~

      shared/schema.ts:67:3
        67   rating: decimal("rating", { precision: 2, scale: 1 }).default("0.0"),
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        The expected type comes from property 'rating' which is declared here on type '{ location: string; userId: string; licenseNumber: string; specialization: Json; experienceYears: number; languages: Json; hourlyRate?: string | null | undefined; bio?: string | null | undefined; ... 5 more ...; totalRatings?: number | ... 1 more ... | undefined; }'
    server/__tests__/routes.test.ts:310:7 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    310       it('should retrieve lawyers list', async () => {
              ~~
    server/__tests__/routes.test.ts:316:9 - error TS2304: Cannot find name 'expect'.

    316         expect(Array.isArray(response.body)).toBe(true);
                ~~~~~~
    server/__tests__/routes.test.ts:317:9 - error TS2304: Cannot find name 'expect'.

    317         expect(response.body).toHaveLength(1);
                ~~~~~~
    server/__tests__/routes.test.ts:318:9 - error TS2304: Cannot find name 'expect'.

    318         expect(response.body[0].specialization).toBe('Criminal Law');
                ~~~~~~
    server/__tests__/routes.test.ts:319:9 - error TS2304: Cannot find name 'expect'.

    319         expect(response.body[0].user).toBeDefined();
                ~~~~~~
    server/__tests__/routes.test.ts:322:7 - error TS2593: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha` and then add 'jest' or 'mocha' to the types field in your tsconfig.

    322       it('should filter lawyers by specialization', async () => {
              ~~
    server/__tests__/routes.test.ts:328:9 - error TS2304: Cannot find name 'expect'.

    328         expect(response.body).toHaveLength(1);
                ~~~~~~
    server/__tests__/routes.test.ts:329:9 - error TS2304: Cannot find name 'expect'.

    329         expect(response.body[0].specialization).toContain('Criminal');
                ~~~~~~

 FAIL  tests/unit/storage.test.ts
  ● Test suite failed to run

    tests/unit/storage.test.ts:111:55 - error TS2345: Argument of type '{ sessionId: string; content: string; role: "user"; }' is not assignable to parameter of type '{ userId: string; sessionId: string; content: string; sender: string; metadata?: Json | undefined; }'.
      Type '{ sessionId: string; content: string; role: "user"; }' is missing the following properties 
from type '{ userId: string; sessionId: string; content: string; sender: string; metadata?: Json | undefined; }': userId, sender

    111       const message = await storage.createChatMessage(messageData);
                                                              ~~~~~~~~~~~
    tests/unit/storage.test.ts:115:22 - error TS2339: Property 'role' does not exist on type '{ id: string; createdAt: Date | null; userId: string; sessionId: string; content: string; sender: string; metadata: unknown; }'.

    115       expect(message.role).toBe('user');
                             ~~~~
    tests/unit/storage.test.ts:135:9 - error TS2353: Object literal may only specify known properties, 
and 'role' does not exist in type '{ userId: string; sessionId: string; content: string; sender: string; metadata?: Json | undefined; }'.

    135         role: 'user'
                ~~~~
    tests/unit/storage.test.ts:141:9 - error TS2353: Object literal may only specify known properties, 
and 'role' does not exist in type '{ userId: string; sessionId: string; content: string; sender: string; metadata?: Json | undefined; }'.

    141         role: 'assistant'
                ~~~~
    tests/unit/storage.test.ts:171:49 - error TS2345: Argument of type '{ userId: string; specialization: string; location: string; licenseNumber: string; experience: number; languages: string[]; }' is not 
assignable to parameter of type '{ userId: string; licenseNumber: string; specialization: string; experienceYears: number; practiceAreas: Json; languages: Json; officeAddress?: string | null | undefined; description?: string | ... 1 more ... | undefined; hourlyRate?: number | ... 1 more ... | undefined; verified?: boolean | ... 1 more ... | undefin...'.
      Type '{ userId: string; specialization: string; location: string; licenseNumber: string; experience: number; languages: string[]; }' is missing the following properties from type '{ userId: string; licenseNumber: string; specialization: string; experienceYears: number; practiceAreas: Json; languages: Json; officeAddress?: string | null | undefined; description?: string | ... 1 more ... | undefined; hourlyRate?: number | ... 1 more ... | undefined; verified?: boolean | ... 1 more ... | undefin...': experienceYears, practiceAreas

    171       const lawyer = await storage.createLawyer(lawyerData);
                                                        ~~~~~~~~~~
    tests/unit/storage.test.ts:175:21 - error TS2339: Property 'location' does not exist on type '{ id: string; createdAt: Date | null; updatedAt: Date | null; userId: string; licenseNumber: string; specialization: string; experienceYears: number; practiceAreas: unknown; languages: unknown; ... 5 more ...; totalReviews: number | null; }'.

    175       expect(lawyer.location).toBe(lawyerData.location);
                            ~~~~~~~~
    tests/unit/storage.test.ts:176:21 - error TS2339: Property 'experience' does not exist on type '{ id: string; createdAt: Date | null; updatedAt: Date | null; userId: string; licenseNumber: string; specialization: string; experienceYears: number; practiceAreas: unknown; languages: unknown; ... 5 more ...; totalReviews: number | null; }'.

    176       expect(lawyer.experience).toBe(5);
                            ~~~~~~~~~~
    tests/unit/storage.test.ts:198:9 - error TS2353: Object literal may only specify known properties, 
and 'location' does not exist in type '{ userId: string; licenseNumber: string; specialization: string; experienceYears: number; practiceAreas: Json; languages: Json; officeAddress?: string | null | undefined; description?: string | ... 1 more ... | undefined; hourlyRate?: number | ... 1 more ... | undefined; verified?: boolean | ... 1 more ... | undefin...'.

    198         location: 'Yaoundé',
                ~~~~~~~~
    tests/unit/storage.test.ts:207:9 - error TS2353: Object literal may only specify known properties, 
and 'location' does not exist in type '{ userId: string; licenseNumber: string; specialization: string; experienceYears: number; practiceAreas: Json; languages: Json; officeAddress?: string | null | undefined; description?: string | ... 1 more ... | undefined; hourlyRate?: number | ... 1 more ... | undefined; verified?: boolean | ... 1 more ... | undefin...'.

    207         location: 'Douala',
                ~~~~~~~~
    tests/unit/storage.test.ts:238:69 - error TS2345: Argument of type '{ userId: string; type: string; code: string; }' is not assignable to parameter of type '{ code: string; type: string; userId: string; expiresAt: Date; used?: boolean | null | undefined; }'.
      Property 'expiresAt' is missing in type '{ userId: string; type: string; code: string; }' but required in type '{ code: string; type: string; userId: string; expiresAt: Date; used?: boolean | null | undefined; }'.

    238       const verificationCode = await storage.createVerificationCode(codeData);
                                                                            ~~~~~~~~

      shared/schema-pg.ts:81:3
        81   expiresAt: timestamp("expires_at").notNull(),
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        'expiresAt' is declared here.

Test Suites: 7 failed, 1 passed, 8 total
Tests:       1 failed, 10 passed, 11 total
Snapshots:   0 total
Time:        56.193 s
Ran all test suites.
PS C:\Users\USER\Desktop\LegalNavigator> 